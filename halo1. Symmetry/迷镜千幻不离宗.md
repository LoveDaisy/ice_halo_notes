# 现代冰晕研究漫谈(1): 迷镜千幻不离宗

![墙纸](wallpaper_p6m.png)

在上一篇序言《[现代冰晕研究漫谈(0): 风起青萍之末](https://zhuanlan.zhihu.com/p/461810067)》里提到了我写这个系列的一个动机，是对冰晶光路进行分类，那么这一篇就细说一下冰晶光路的分类。

为什么要对光路进行分类？在序言里我提到一个朴素直观的出发点：冰晶是有对称性的，如果用表面编号来记录光路，就会产生许多冗余，比如 3-5 光路和 4-6、5-7 等光路都是一回事，不仅如此，实际上它还和 3-7、4-8 等光路也是一回事。

![光路的对称性](raypath_symmetry.png)

冗余总是不太令人舒服的，给记录和交流都会带来麻烦，对于不熟悉的人来说可能会犯下「西红柿炒番茄」这样的笑话。所以我们要划分等价类，把那些等价的光路都分到同一类里，然后我们按不同的等价类来讨论，就不会有冗余了。那怎么进行分类呢？从集合论的角度来说，划分等价类关键在于找到「等价关系」。

这里岔开去说两句，我记得本科大一的时候上线性代数，我们的课程名字叫代数与几何，课本第一章上来就从群、环、域讲起，「等价类」就是开头的几个重要概念之一。这种讲法和一般线性代数从行列式和方程组讲起就很不一样，一开始我也着实适应了很久，考试的分数也不高。可是在后来的学习、研究和工作中，越来越深刻体会到「结构」在数学中的重要性，而等价关系，就是对数学结构的反映。现代的代数研究很看重几何直观，我们课程的这种讲法其实是高屋建瓴的，课程名叫代数与几何，也是非常贴切的，这种认知对我后面的学习研究帮助非常大。

扯远了，说回来，这里说到关键在于找到等价关系。在冰晕光路里有什么样的等价关系呢？从我们朴素的直觉来看，六棱柱冰晶的六个侧面（3~8号面）显然是等价的，以哪个侧面为起点都是一样的，这是绕主轴（穿过棱柱两个底面的轴，也是晶体学里的 c 轴）的旋转对称性。在 HaloPoint 2.0 里，作者用 P（Prism）对称性来称呼，意思是棱柱侧面的对称性：

> Symmetries P, where P stands for Prism. If this checkbox is checked, all identical raypaths, regardless of the first prism face encountered, are found. For parhelia this means, that all raypaths contributing to left parhelion are found if raypath entry is 3-5 and P-symmetry is checked. Right parhelion is found if raypath entry is changed to 3-7.

以下是自己的翻译

> P 对称性，这里 P 代表棱柱（Prism）。如果这个选择了选项，那么程序将找出所有的等价光路，他们仅是入射面不同。对于幻日来说，如果光路是 3-5 并且选中了 P 对称性，那么程序会找出所有参与左幻日的光路；相对应的，如果光路换成 3-7 那么就是右幻日。

所以这里一共有 6 种对称操作，经过操作之后，光路和原来的是等价的。这 6 种操作依次是：什么都不做（旋转 0°）、向左旋转 60°（当然向右也可以，这里选择向左）、向左旋转 120°、向左旋转 180°、向左旋转 240°、向左旋转 300°。以三维点群（[Point groups in three dimensions](https://en.wikipedia.org/wiki/Point_groups_in_three_dimensions)）的术语来说，这些对称操作构成了一个 $C_6$ 群（采用 Schönflies 记号，或者写作 Schoenflies，[Schoenflies notation](https://en.wikipedia.org/wiki/Schoenflies_notation)），一共有 6 个元素。为方便起见，我们不妨给他们分别记为 $R^c_0=I$，$R^c_1$，$R^c_2$，$R^c_3$，$R^c_4$，$R^c_5$，这里 $R$ 代表旋转（Rotation），上标 $c$ 表示这些都是绕 c 轴（在这里就是垂直纸面的轴）的旋转，$I$ 表示恒等变换（Identity）。

![旋转对称群](c6.png)

写出群表就是：

![c6群表](c6_table.png)

这个表 i 行 j 列的元素，表示先进行 i 操作再进行 j 操作，结果是什么，比如 2 行 3 列，表示先左转 60°（第 2 行是 $R^c_1$）再左转 120°（第 3 列是 $R^c_2$），那么就等于直接左转 180°（2 行 3 列是 $R^c_3$）。

这种旋转对称性对光路是什么影响呢？对于两个底面（1 号和 2 号面）来说，旋转操作没有任何影响，保持数字不变。对于所有的侧面（3~8 号面）来说，$R^c_k, k = 0, 1, 2, \dots$  的作用就是将面的编号数字 $n$ 增加 $k$（在对 6 取模的意义下），也就是：
$$
R^c_k(n) \equiv n+k \pmod{6},\quad k=0,1,2,\dots, \text{and} \;\; n=3,4,\dots,8
$$
这在程序里就很好处理了，加一个数再取余么（注意起点是 3 而不是 0 就好了）。比如 1-5-2-7-1 光路，左转 120°（$R^c_2$ 变换，于是就 +2），就变成 1-7-2-3-1 光路。（不妨猜猜看这个光路是什么晕？）

好了，我们得到了第一个等价类划分，也就是按照 $C_6$ 群的变换进行划分，如果两条光路能在 $C_6$ 中的变换下变成一样，就属于同一个等价类。这也是 HaloPoint 2.0 里 P 对称性。

还有没有其他的对称性呢？显然有的，正如上面 HaloPoint 2.0 作者提到的，对于幻日来说，如果只考虑 P 对称性，那么就只能得到左/右幻日里的一个，他们分别是 3-5 光路和 3-7 光路。（一个思考题，下面的 3-5 光路模拟图中，为什么只有幻日是单边的，上下切弧、帕里弧、22° 晕都是完整的）

![3-5光路的幻日](halos_3-5.jpg)

我们是不是可以考虑增加对称性，把这两种光路划分到一个等价类里呢？HaloPoint 2.0 作者提出了 D（Direction）对称性：

> Symmetries D, where D stands for Direction. This checkbox enables "directional symmetry", which allows equal raypaths, but coming from different directions, to be found. For parhelia this means, that raypath 3-5 and 3-7 are equal, and so both raypaths are found.

以下是自己的翻译

> D 对称性，这里 D 代表方向（Direction）。这个选项考虑了“方向对称性”，它会让程序找到所有从两个不同方向过来的等价光路。对于幻日来说，3-5 光路和 3-7 光路是等价的，所以程序会把这两种光路都找出来。

画一个图容易看到，3-5 光路和 3-7 光路，正好是互为镜像的两个光路，他们的对称轴（镜面）是沿着 3 号面和 6 号面中点的连线，在 2 维的图里画出来是一条线，在 3 维空间里这是一个包含主轴（c 轴）的平面。这种对称性和刚才的旋转对称不一样，这是镜面对称（反射对称）。

刚才找到了 6 种旋转对称操作，那镜面对称有几种呢？也是 6 种。正六边形有 3 条对角线，有 3 条对边中点的连线，以这 6 条线为对称轴（镜面）进行反射，这就是全部的反射对称操作。

![反射对称操作](d6_f.png)

为方便起见，我们给他们分别记为 $F^f_3$，$F^f_4$，$F^f_5$，$F^d_{3,4}$，$F^d_{4,5}$，$F^d_{5,6}$，这里 $F$ 代表翻转（Flip），上标 $f$ 表示对面（face）中点连线作为对称轴，$d$ 表示对角线（diagonal）作为对称轴，下标数字代表了具体哪一条线。这 6 种反射对称操作和上面提到的 6 种旋转对称操作合起来，构成了二面体对称群 $D_6$，总共 12 个元素。

![d6群表](d6_table_shade.png)

表的左上角，就是前面写出来的 $C_6$ 子群。需要注意的是，这里提到的 6 个反射操作本身并不单独构成群，因为两个反射操作结合起来，会变成一个旋转操作，从这个表里可以很容易看到，比如 $F^f_3 \circ F^d_{4,5} = R^c_3$（大家可以自己画画图看看），而不再是反射操作。

这些反射操作对于光路是什么影响呢？对于两个底面，显然还是没有任何影响。对于侧面 $n$ 来说，有：
$$
\begin{align}
F^f_{k}(n) &\equiv -n-k \pmod{6} \\[.5em]
F^d_{k,k+1}(n) &\equiv -n+k \pmod{6}
\end{align}\;\,, \quad k=3,4,5,\; \text{and}\;\; n=3,4,\dots,8
$$
这在程序里同样非常好处理，取相反数再加减一个数最后取余。

至此我们得到了第二个（对称性更高的）等价类划分，按照 $D_6$ 群里的变换进行划分。根据上文的讨论我们知道，HaloPoint 2.0 里的 D 对称操作本身不构成群，还要加上 P 对称操作（旋转对称）才构成群。所以我们这第二个等价类的划分，实际上等同于 HaloPoint 2.0 里 P + D 对称性。

这里不得不吐槽一下 HaloPoint 2.0 里的 D 对称性了，按照他的定义，D 对称性几乎不会单独使用。他只考虑一种单纯的镜面对称。可是既然我都考虑镜面对称了，当然是希望用更高的对称性，把更多「本质上」形成了同一种晕（比如左右幻日）的光路都包括进来。要达到这样的目的，在 HaloPoint 2.0 里面就要同时勾选 P + D 对称性才行。单独的 D 对称性就显得有点鸡肋。

那么，还有没有更多的对称性呢？还是有的。我们上面讨论的都是针对 6 个侧面的对称性，都没有考虑针对底面的，在 HaloPoint 2.0 里作者称之为 B（Basal）对称性：

> Symmetries B, where B stands for Basal. If this checkbox is checked, both basal faces are treated as equal. For raypath 3-1-5 (Wegener anthelic arc) only the loop starting towards west from 22° upper tangent arc (and closing in to 22° lower tangent arc from east) is found unless B is checked. When checked, the reflections from basal face 2 are also considered, and thus the raypath 3-2-5 is also found.

我自己的翻译

> B 对称性，这里 B 代表底面（Basal）。如果选择了这个选项，程序将两个底面当做是等价的。对于 3-1-5 光路（魏格纳反日弧）来说，如果不选 B 对称性，那么只会显示一半的弧，从西边 22° 上切弧开始，到东边 22° 下切弧结束；如果选了 B 对称性，那么程序也会考虑 2 号面的反射光路 3-2-5（从而显示完整的反日弧）。

底面对称性是最好理解的，相当于在棱柱中间拦腰插入一面镜子，然后作镜像对称。

把这个底面反射的操作作用于前面提到的 12 种变换上，就得到了新的 12 种变换，为方便起见，我这里把前面的 12 种变换的记号上面加一弯，表示新的 12 种变换操作，比如 $F^f_3$ 对应 $\tilde{F}^f_3$：
$$
\tilde{g}(n) \equiv n+1 \pmod{2}\,, \quad g\in D_6,\;\; \text{and}\;\; n=1,2
$$
于是，这里总共 24 种变换整个又构成一个群，叫棱柱对称群 $D_{6h}$（参考 wiki 条目里中文的写法，对应英文是 prismatic symmetry）。

在程序里就更容易了，就是把 1 和 2 互相交换，2 变 1、1 变 2 就行。

到这里终于把所有的对称变换全部列举完了，按照 HaloPoint 2.0 软件里的记号，$D_{6h}$ 等同于 P + D + B 对称性，这是对称性最高的划分方式，考虑了一条光路的所有对称可能性。

（本来想把整个 $D_{6h}$ 群的群表放过来，但是太大了，就算了，假装这里有一个 24 × 24 的大表格）

这里我继续吐槽一下 HaloPoint 2.0 里的 B 对称性，如果大家有使用 HaloPoint 2.0 做过模拟就会发现，基本上 B 对称性都没什么作用，P + D + B 基本上和 P + D 是一样的。用刚刚介绍的知识，我们分析一下可以知道，$D_{6h}$ 比 $D_6$ 多出来的那些变换，全部是和 $D_6$ 本身的变换一一对应的。画出整个群表我们就很容易发现，如果考虑两个变换复合操作，那么这些多出来的变换，全部可以由 $D_6$ 本身的变换复合得到——也就是说，全部可以由 HaloPoint 2.0 里的 P + D 对称性得到。这也表明了 HaloPoint 2.0 里 B 对称性比 D 对称性更加鸡肋（貌似也有时候 B 对称性选与不选是有区别的，我并不知道其中软件上实现的具体细节，我自己的程序里，P/D/B 对称性分别对应上文提到的 6 个旋转、6 个包含主轴的反射、1 个垂直主轴的反射，是符合这里的分析的，B 对称性完全可以由 P + D 对称性得到）。

我们现在有 3 种不同的群 $C_6$，$D_6$，$D_{6h}$，利用这些群里的元素（就是一个个的变换）处理一条光路，总可以得到一条字典序最小的光路（光路的字典序，就是挨个从第一面到最后一面比较编号大小，编号小的排前面），我们可以把这条光路叫做在某个群作用下的正则光路，用来作为等价类的代表。

举个例子，比如 2-8-7-5-1 光路，在 $C_6$ 群的作用下可以变成 2-3-8-6-1，2-4-3-7-1 等不同的光路，而其中字典序最小的就是 2-3-8-6-1 了，可以作为 $C_6$ 群作用下的正则光路，代表这一系列等价的光路。如果考虑 $D_6$ 群的作用，那么除了上面提到的光路之外，还可以变成 2-7-8-4-1，2-3-4-6-1 等，其中 2-3-4-6-1 拥有更小的字典序。如果考虑 $D_{6h}$ 群的话，1-3-4-6-2 拥有最小的字典序，在 $D_{6h}$ 作用下，上面所有这些光路都是同一个等价光路。

这个做法非常适合用程序来做判断，任意两条光路，依据适用的群（不同程度的对称性），把他们转化为正则光路，然后进行比较，如果是一样的，那么原本的两条光路就是等价光路；如果不一样，那么就不是等价光路。

现在终于可以说，我们能够终结光路的等价划分问题了，利用群论的知识，可以**有条不紊、不重不漏**地进行划分（这八个字是关键，这也是利用群论系统性分析比依靠朴素直觉来归纳要优越的地方），还可以按照对称性从小到大，各取所需。

这里倒不是说 HaloPoint 2.0 里面 B/D/P 对称性划分不对，只是我觉得这样的划分出发点还是一些朴素的直觉，不够系统，有时候单拿一个对称性出来又显得有些别扭（比如上文提到的，单独的 D 对称性很是鸡肋，而 B 对称性又可以由 P + D 对称性复合得到）；而且这种划分方式也不够抽象，很多时候是靠观察来得到的，而不是通过一些理性的分析得到。对于六棱柱晶体的冰晶，我们还容易想象（其实也不容易了），那么对于其他晶体呢？比如正六面体的氯化钠晶体，比如双四棱锥的二氧化碳晶体，甚至于对称性更少的锂辉石晶体，这些晶体的光路要怎么划分等价类呢？又怎么保证没有重复的分类、或者没有遗漏的分类呢？如果还是从朴素直觉的角度，难度就大了，而利用变换群进行划分的话，就不会重复计算；并且群论告诉我们，三维点群一共就那么几种（可以证明，一共 32 种晶体点群，参见 [Crystallographic point group](https://en.wikipedia.org/wiki/Crystallographic_point_group)），实在不行就挨个看一眼嘛，肯定也就不会遗漏了。

不仅如此，棱柱对称群 $D_{6h}$ 也是六方晶系下的对称变换群，这里就可以和晶体学联系起来了，从水的分子结构、晶体点阵，自然可以导出光路划分的对称群用 $D_{6h}$ 很合理，然后根据 $D_{6h}$ 还包含 $D_6$ 和 $C_6$ 子群结构，自然得出另外两个对称性较低的划分方式。这种反过来思考的模式，是不是有点像牛顿力学 vs. 分析力学？直接从抽象的对称性出发，自然地推导出牛顿力学的各种性质。拉格朗日创立分析力学是力学的现代化运动开端，而我在这里稍微厚颜一点想效仿一下，希望这一系列文章能给人以启发，为冰晕研究带来一些现代化的新思路、建设更完备的研究体系。

（彩蛋一个：有人看出题图是什么吗？）

